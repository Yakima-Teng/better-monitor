import{_ as s,o as a,c as n,U as o}from"./chunks/framework.dfac195e.js";const A=JSON.parse('{"title":"better-monitor","description":"","frontmatter":{},"headers":[],"relativePath":"index.md","filePath":"README.md"}'),l={name:"index.md"},p=o(`<h1 id="better-monitor" tabindex="-1">better-monitor <a class="header-anchor" href="#better-monitor" aria-label="Permalink to &quot;better-monitor&quot;">​</a></h1><div align="center" style="display:flex;align-items:center;justify-content:center;gap:8px;"><img style="width:200px;" src="https://github.com/Yakima-Teng/better-monitor/raw/main/attachments/logo.svg"></div><p align="center" style="display:flex;align-items:center;justify-content:center;gap:8px;"><a href="https://npmcharts.com/compare/better-monitor?minimal=true"><img src="https://img.shields.io/npm/dm/better-monitor.svg" alt="Downloads"></a><a href="https://www.npmjs.com/package/better-monitor"><img src="https://img.shields.io/npm/v/better-monitor.svg" alt="Version"></a><a href="https://www.npmjs.com/package/better-monitor"><img src="https://img.shields.io/npm/l/better-monitor.svg" alt="License"></a></p><p><a href="https://yakima-teng.github.io/better-monitor/index_en.html" target="_blank" rel="noreferrer">Click here for English document</a>.</p><blockquote><p>用于向网站监控服务上传数据的前端JS SDK（集成了后台服务，可以直接使用<a href="https://www.verybugs.com/admin/" target="_blank" rel="noreferrer">官方管理面板</a>），支持拦截AJAX请求，上报JS运行时错误等。</p></blockquote><h2 id="功能特性" tabindex="-1">功能特性 <a class="header-anchor" href="#功能特性" aria-label="Permalink to &quot;功能特性&quot;">​</a></h2><ul><li>🔥 上报 PV（page view） 数据。从而得知网站上哪些页面被访问得更频繁。</li><li>🔥 上报 UV（user view） 数据。从而得知有多少用户访问了你的项目。</li><li>🔥 上报 BV（browser view） 数据。从而得知用户使用哪些操作系统下的哪些浏览器来访问我们的项目。可以据此进一步确定网站的前端兼容性计划。</li><li>🔥 上报 AJAX 请求和响应数据。该 SDK 会自动拦截通过原生 XMLHttpRequest对象或者诸如 Axios 和 jQuery 等库触发的 AJAX 请求。可以据此查看哪些请求响应速度过慢。</li><li>🔥 上报 JavaScript 运行时报错数据。</li><li>🔥 上报用户行为数据（按时间顺序）。</li><li>🔥 上报页面性能数据（CLS、TTFB、LCP、INP、FCP、FID）。</li></ul><h2 id="如何使用" tabindex="-1">如何使用 <a class="header-anchor" href="#如何使用" aria-label="Permalink to &quot;如何使用&quot;">​</a></h2><h3 id="获取项目id" tabindex="-1">获取项目ID <a class="header-anchor" href="#获取项目id" aria-label="Permalink to &quot;获取项目ID&quot;">​</a></h3><p>首先，你需要注册并登录我们的<a href="https://www.verybugs.com/admin/" target="_blank" rel="noreferrer">管理面板</a>来获取项目ID。</p><p><img src="https://github.com/Yakima-Teng/better-monitor/raw/main/attachments/get-project-id.png" alt=""></p><h3 id="集成sdk并进行配置" tabindex="-1">集成SDK并进行配置 <a class="header-anchor" href="#集成sdk并进行配置" aria-label="Permalink to &quot;集成SDK并进行配置&quot;">​</a></h3><p>通过NPM将 better-monitor 作为项目依赖进行安装：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-S</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">better-monitor</span></span></code></pre></div><p>然后按如下方式将我们刚刚获取到的项目ID配置进去即可：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> BetterMonitor </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">better-monitor</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">init</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// fill in your project ID here</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">projectId</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p><strong>如果你的项目目前未使用NPM，也可以通过HTML Script标签来引入SDK，具体操作如下：</strong></p><p>说明：可以看到，项目ID是直接以data-project-id属性的方式配置到script元素上的。</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- data-project-id 的值就是我们获取的项目ID --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">crossorigin</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">anonymous</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">data-project-id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://cdn.orzzone.com/verybugs/better-monitor.min.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><h3 id="特殊处理" tabindex="-1">特殊处理 <a class="header-anchor" href="#特殊处理" aria-label="Permalink to &quot;特殊处理&quot;">​</a></h3><p>如果你的项目使用了 <code>Vue3</code>，由于该框架会全局捕获框架内抛出的错误并最终通过 <code>console.error</code> 的方式打印，不会通过 <code>throw</code> 的方式抛出错误，为了捕获对应的错误日志，需要这样处理一下：</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight has-focused-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createApp</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vue</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> BetterMonitor </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">better-monitor</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> App </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./App.vue</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createApp</span><span style="color:#A6ACCD;">(App)</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">errorHandler</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">vm</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">info</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span></span>
<span class="line has-focus"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// eslint-disable-next-line no-console</span></span>
<span class="line has-focus"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">errorHandler</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vm</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">info</span><span style="color:#F07178;">)</span></span>
<span class="line has-focus"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addBug</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line has-focus"><span style="color:#F07178;">    pageUrl</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">location</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span></span>
<span class="line has-focus"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// @ts-ignore</span></span>
<span class="line has-focus"><span style="color:#F07178;">    message</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">message</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unknown bug</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line has-focus"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// @ts-ignore</span></span>
<span class="line has-focus"><span style="color:#F07178;">    stack</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">stack</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line has-focus"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// @ts-ignore</span></span>
<span class="line has-focus"><span style="color:#F07178;">    source</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">name=</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">vm</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">__name</span><span style="color:#89DDFF;">}\`</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">scopeId=</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">vm</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">__scopeId</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&amp;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line has-focus"><span style="color:#F07178;">    type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">info</span></span>
<span class="line has-focus"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line has-focus"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 其他代码...</span></span></code></pre></div><p>如果你的项目使用了 <code>Vue2</code>，则需要类似这样处理一下：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> Vue </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vue</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 其他代码...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">Vue</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">errorHandler</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">vm</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">info</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// eslint-disable-next-line no-console</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">errorHandler</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vm</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">info</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">addBug</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">addBug</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addBug</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        pageUrl</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">location</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// @ts-ignore</span></span>
<span class="line"><span style="color:#F07178;">        message</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unknown bug</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// @ts-ignore</span></span>
<span class="line"><span style="color:#F07178;">        stack</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">stack</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// @ts-ignore</span></span>
<span class="line"><span style="color:#F07178;">        source</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">name=</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">(vm </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> vm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">$vnode </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> vm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">$vnode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tag) </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;}\`</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">data=</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">(vm </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> vm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">_data) </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#A6ACCD;">(vm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">_data) </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;}\`</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&amp;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">info</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// eslint-disable-next-line no-console</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 其他代码...</span></span></code></pre></div><h2 id="api" tabindex="-1">API <a class="header-anchor" href="#api" aria-label="Permalink to &quot;API&quot;">​</a></h2><p>该 SDK 对外暴露了几个实用的 API：</p><h3 id="bettermonitor-printlog" tabindex="-1">BetterMonitor.printLog <a class="header-anchor" href="#bettermonitor-printlog" aria-label="Permalink to &quot;BetterMonitor.printLog&quot;">​</a></h3><p><code>BetterMonitor.printLog</code> 和 <code>console.log</code> 几乎是一样的，除了以下几点：</p><ul><li>输出的日志会在最前面显示一个日期前缀。</li><li>这些日志会被上报到服务端（日志级别为 <code>log</code> ），你可以在管理面板上进行查看。</li></ul><blockquote><p>注意，通过 <code>BetterMonitor.printLog</code> 打印的日志并不会实时上报，而是在达到一定长度或者数量时才会上报，如果需要实时上报，请使用 <code>BetterMonitor.printLogDirectly</code> 方法。</p></blockquote><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printLog</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">printLog</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>输出如下：</p><p><img src="https://github.com/Yakima-Teng/better-monitor/raw/main/attachments/log-api-example.png" alt=""></p><h3 id="bettermonitor-printwarn" tabindex="-1">BetterMonitor.printWarn <a class="header-anchor" href="#bettermonitor-printwarn" aria-label="Permalink to &quot;BetterMonitor.printWarn&quot;">​</a></h3><p>与 <code>BetterMonitor.printLog</code> 类似，区别在于：</p><ul><li>输出的文本颜色为棕黄色。</li><li>日志级别为 <code>warn</code>。</li></ul><blockquote><p>注意，通过 <code>BetterMonitor.printWarn</code> 打印的日志并不会实时上报，而是在达到一定长度或者数量时才会上报，如果需要实时上报，请使用 <code>BetterMonitor.printWarnDirectly</code> 方法。</p></blockquote><h3 id="bettermonitor-printerror" tabindex="-1">BetterMonitor.printError <a class="header-anchor" href="#bettermonitor-printerror" aria-label="Permalink to &quot;BetterMonitor.printError&quot;">​</a></h3><p>与 <code>BetterMonitor.printLog</code> 类似，区别在于：</p><ul><li>输出的文本颜色为红色。</li><li>日志级别为 <code>error</code>.</li></ul><blockquote><p>注意，通过 <code>BetterMonitor.printError</code> 打印的日志并不会实时上报，而是在达到一定长度或者数量时才会上报，如果需要实时上报，请使用 <code>BetterMonitor.printErrorDirectly</code> 方法。</p></blockquote><h3 id="bettermonitor-logtime-bettermonitor-logtimeend" tabindex="-1">BetterMonitor.logTime, BetterMonitor.logTimeEnd <a class="header-anchor" href="#bettermonitor-logtime-bettermonitor-logtimeend" aria-label="Permalink to &quot;BetterMonitor.logTime, BetterMonitor.logTimeEnd&quot;">​</a></h3><p><code>BetterMonitor.logTime</code> 和 <code>BetterMonitor.logTimeEnd</code> 需要组合使用, 使用方法与 <code>console.time</code> 和 <code>console.timeEnd</code> 类似. 它们与 <code>console.time</code> 和 <code>console.timeEnd</code> 的区别在于：</p><ul><li>如果开始和结束时间之间的间隔时长少于100ms，输出的日志会带有“耗时较快”文案。日志上报级别为 <code>log</code>。</li><li>如果开始和结束时间之间的间隔等于或大于100ms，输出的日志会带有“耗时较慢”文案。日志上报级别为 <code>error</code>。</li></ul><p>从而可以方便地过滤出较慢的操作有哪些。</p><blockquote><p>注意，通过 <code>BetterMonitor.logTimeEnd</code> 打印的日志并不会实时上报，而是在达到一定长度或者数量时才会上报，如果需要实时上报，请使用 <code>BetterMonitor.logTimeEndDirectly</code> 方法。</p></blockquote><h3 id="bettermonitor-init" tabindex="-1">BetterMonitor.init <a class="header-anchor" href="#bettermonitor-init" aria-label="Permalink to &quot;BetterMonitor.init&quot;">​</a></h3><p>初始化配置。一般进需要传入<code>projectId</code>参数。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">init</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">projectId</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>如果你希望日志能区分不同用户，可以重写一个 <code>getUserId</code> 方法（支持 Promise），不重写该方法的话，默认的 <code>userId</code> 始终为 <code>0</code>。示意如下：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">BetterMonitor</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">init</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">projectId</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">getUserId</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">123</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><blockquote><p>注意，出于性能考虑，每次上报时使用的 <code>userId</code> 都是上一次执行 <code>getUserId</code> 时获取到的值。</p></blockquote><h3 id="bettermonitor-addview-bettermonitor-addbug" tabindex="-1">BetterMonitor.addView, BetterMonitor.addBug <a class="header-anchor" href="#bettermonitor-addview-bettermonitor-addbug" aria-label="Permalink to &quot;BetterMonitor.addView, BetterMonitor.addBug&quot;">​</a></h3><p>这些API很少会被用到，如确有需要，可以自行查看源码。</p><h2 id="部分截图预览" tabindex="-1">部分截图预览 <a class="header-anchor" href="#部分截图预览" aria-label="Permalink to &quot;部分截图预览&quot;">​</a></h2><p><strong>统计面板：</strong></p><p><img src="https://github.com/Yakima-Teng/better-monitor/raw/main/attachments/dashboard.png" alt="Dashboard"></p><p><strong>接口日志：</strong></p><p><img src="https://github.com/Yakima-Teng/better-monitor/raw/main/attachments/api-log.png" alt="API log"></p><p><strong>JS Bug日志：</strong></p><p><img src="https://github.com/Yakima-Teng/better-monitor/raw/main/attachments/bug-log.png" alt="Bug management"></p><p><strong>用户行为日志列表：</strong></p><p><img src="https://github.com/Yakima-Teng/better-monitor/raw/main/attachments/action-log.png" alt="Action log list"></p><p><strong>用户行为日志文件：</strong></p><p><img src="https://github.com/Yakima-Teng/better-monitor/raw/main/attachments/action-log-file.png" alt="Action log file"></p><p><strong>项目管理：</strong></p><p><img src="https://github.com/Yakima-Teng/better-monitor/raw/main/attachments/project-management.png" alt="Project management"></p><h2 id="开源协议" tabindex="-1">开源协议 <a class="header-anchor" href="#开源协议" aria-label="Permalink to &quot;开源协议&quot;">​</a></h2><p>MIT协议。</p><p>开源地址：<a href="https://github.com/Yakima-Teng/better-monitor" target="_blank" rel="noreferrer">https://github.com/Yakima-Teng/better-monitor</a>。</p>`,70),t=[p];function e(r,c,i,D,y,F){return a(),n("div",null,t)}const d=s(l,[["render",e]]);export{A as __pageData,d as default};
